#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <ctype.h>
#define MAX 100

typedef struct { char arr[MAX]; int top; } CharStack;
void initC(CharStack* s){ s->top=-1; }
int emptyC(CharStack* s){ return s->top==-1; }
void pushC(CharStack* s,char c){ s->arr[++s->top]=c; }
char popC(CharStack* s){ return s->arr[s->top--]; }
char peekC(CharStack* s){ return s->arr[s->top]; }

typedef struct { int arr[MAX]; int top; } IntStack;
void initI(IntStack* s){ s->top=-1; }
void pushI(IntStack* s,int v){ s->arr[++s->top]=v; }
int popI(IntStack* s){ return s->arr[s->top--]; }

int prec(char c){ return (c=='+'||c=='-')?1:(c=='*'||c=='/')?2:0; }

void infixToPostfix(char* infix,char* postfix){
    CharStack s; initC(&s); int j=0;
    int i;
    for(i=0; infix[i]; i++){
        char c=infix[i];
        if(isdigit(c)) postfix[j++]=c;
        else if(c=='(') pushC(&s,c);
        else if(c==')'){ while(!emptyC(&s)&&peekC(&s)!='(') postfix[j++]=popC(&s); popC(&s); }
        else if(strchr("+-*/",c)){
            while(!emptyC(&s)&&prec(peekC(&s))>=prec(c)) postfix[j++]=popC(&s);
            pushC(&s,c);
        }
    }
    while(!emptyC(&s)) postfix[j++]=popC(&s);
    postfix[j]='\0';
}

int evalPostfix(char* postfix){
    IntStack s; initI(&s);
    int i;
    for(i=0; postfix[i]; i++){
        char c=postfix[i];
        if(isdigit(c)) pushI(&s,c-'0');
        else{
            int b=popI(&s), a=popI(&s);
            switch(c){ case '+': pushI(&s,a+b); break;
                        case '-': pushI(&s,a-b); break;
                        case '*': pushI(&s,a*b); break;
                        case '/': pushI(&s,a/b); break; }
        }
    }
    return popI(&s);
}

int main(){
    char infix[MAX],postfix[MAX];
    printf("Enter infix expression: ");
    fgets(infix,MAX,stdin);
    infix[strcspn(infix,"\n")]='\0';
    infixToPostfix(infix,postfix);
    printf("Postfix Expression: %s\n",postfix);
    printf("Result: %d\n",evalPostfix(postfix));
    return 0;
}
